<div class="bg-white shadow-sm p-3 mb-4 rounded d-flex gap-3">
  <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#modalAbsence">
    <i class="bi bi-plus-circle me-2"></i> Ajouter&nbsp;Absence
  </button>
</div>

<div class="card">
  <table class="table table-bordered table-striped align-middle m-0">
    <thead class="table-dark">
    <tr>
      <th>#</th>
      <th>Date début</th>
      <th>Date fin</th>
      <th>Motif</th>
      <th>Justification</th>
      <th>Stagiaire</th>
      <th>Actions</th>
    </tr>
    </thead>
    <tbody>
    <tr *ngFor="let a of listeAbsences">
      <td>{{ a.idabsence }}</td>
      <td>{{ a.dateDebut | date: 'yyyy-MM-dd' }}</td>
      <td>{{ a.dateFin | date: 'yyyy-MM-dd' }}</td>
      <td>{{ a.motif }}</td>
      <td>{{ a.justification }}</td>
      <td>{{ getNomStagiaire(a.idstagiaire) }}</td>
      <td class="d-flex gap-2">
        <button class="btn btn-warning btn-sm" (click)="modifierAbsence(a)">
          <i class="bi bi-pencil"></i>
        </button>
        <button class="btn btn-danger btn-sm" (click)="supprimerAbsence(a.idabsence!)">
          <i class="bi bi-trash"></i>
        </button>
      </td>
    </tr>
    </tbody>
  </table>
</div>

<!-- Modal -->
<div class="modal fade" id="modalAbsence" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <form [formGroup]="formulaireAbsence" (ngSubmit)="ajouterOuModifierAbsence()">
        <div class="modal-header">
          <h5 class="modal-title">{{ enModification ? 'Modifier une absence' : 'Ajouter une absence' }}</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="row g-3">
            <div class="col-md-6">
              <label class="form-label">Date début</label>
              <input type="date" class="form-control" formControlName="dateDebut">
            </div>
            <div class="col-md-6">
              <label class="form-label">Date fin</label>
              <input type="date" class="form-control" formControlName="dateFin">
            </div>
            <div class="col-md-6">
              <label class="form-label">Motif</label>
              <input type="text" class="form-control" formControlName="motif">
            </div>
            <div class="col-md-6">
              <label class="form-label">Justification</label>
              <input type="text" class="form-control" formControlName="justification">
            </div>
            <div class="col-md-12">
              <label class="form-label">Stagiaire</label>
              <select class="form-select" formControlName="idstagiaire">
                <option [value]="null">-- Sélectionner --</option>
                <option *ngFor="let s of listeStagiaires" [value]="s.idpersonne">
                  {{ s.nom }} {{ s.prenom }}
                </option>
              </select>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annuler</button>
          <button type="submit" class="btn btn-primary" [disabled]="formulaireAbsence.invalid">
            {{ enModification ? 'Enregistrer' : 'Ajouter' }}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
